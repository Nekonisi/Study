
Borland C++ Compiler 5.5
環境ファイル/パス設定プログラム
       「setbcc」

Ver. 1.5b  By Gohodoji(護法童子)



・このプログラムはなに？

  　ボーランド(株)が無償で公開している「Borland C++ Compiler
  5.5.1 日本語版」では，ふたつの設定ファイル(bcc32.cfgとilink32.
  cfg)やパスの設定がされません。このツールでは，これらをウィザ
  ード形式で設定するものです。いちいち手で設定するのが面倒だと
  思ったり，DOSにあまり慣れていない方は使ってください。

  　なお，Borland C++ Compiler 5.5.1 日本語版は，ボーランド(株)
  より発売されるBorland C++ Builder 5以降に含まれているものです。
  本当に初心者なら，製品であるこちらを買ったほうがいいかと思い
  ます:)



・新バージョンの変更点

  ・ドキュメントをちょっと変更(Windows XP/Meに対応)
  ・テキスト表示を広げて全画面見えるようにした
  ・Borland C++Builder 6でコンパイルした



・使い方

  　始めにBorland C++ Compiler 5.5.1 日本語版をインストールしてく
  ださい。これらのパッケージは，いずれもボーランドのWebサイト
  (http://www.borland.co.jp/)にて配布されています。またC MAGAZINE
  を始めとする一部の雑誌に添付されています。

  　パッケージをデフォルトの設定のままでインストールしたのなら，そ
  のまま[次へ>>]ボタンを押していくだけで，足りない設定を補い，ソー
  スコードをコンパイルができるようになります。

  　次にそれぞれの設定画面について解説します。



・Step 1：インストール先フォルダの指定

  　パッケージをインストール(展開)したフォルダ(ディレクトリ名)を
  入力してください。デフォルトのままインストールしたときは，

          c:\Borland\Bcc55\

  になっているはずです。わからない場合は[参照]ボタンを押して，場
  所を確認してください。インストールに指定したのフォルダの下には
  binという名前のフォルダがあり，そこにbcc32.exeなどの実行形式フ
  ァイルが存在しているはずです。

  　また，LAN上のドライブなどネットワーク越しの利用については，
  ネットワークのフォルダを右クリックすると出てくる「ネットワーク
  ドライブの割り当て」を実行してドライブレター(A: とかC: とか)を
  割り当てることで使うことができます。[参照]ボタンでは，ネットワ
  ークグループまでは見えますが，そこから先は見せないようにしてい
  ます。必ず前述の方法を使って，ネットワーグドライブを指定してか
  ら作業を進めてください。



・Step 2: パスの設定方法

  　パスなどの環境変数の設定先を選択します。これにより，DOSプロ
  ンプトからどのフォルダ(ディレクトリ)からでもコンパイルが可能に
  なります。

  　Windows Me/98/95などをお使いの方は，autoexec.batに登録されます。
  　Windows XP/2000/NTをお使いの方は，レジストリ(HKEY_CURRENT_USER\
  Environment，またはHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\
  Control\Session Manager\Environmentに登録されます。

  　これらの設定はコンピュータの再起動後に有効になります。
  　もし，表示されているOSが間違っているようだったら正しいOSを示す
  ボタンを選択してください。



・Step 3: パスの優先度の選択

  　パスの優先度を選択します。通常はデフォルトの「後に」でかまい
  ません。

  　ボーランドのBorland C++Builderをすでにお使いの方で，Borland
  C++ Compilerを優先させて動作させたい人は「先頭に」を選んでくだ
  さい。

  　現在の設定と同じパスを削除したいときは「パスは設定しない」を
  選んでください。



・Step 4: bcc32.cfgファイルの設定

  　bcc32.cfgの内容として，ヘッダファイル(*.h/*.hpp)が置かれてい
  るフォルダ(ディレクトリ)名の指定とライブラリファイル(*.lib/*.obj)
  が置かれているフォルダ(ディレクトリ)名の指定を行います。

  　フォルダ(ディレクトリ)名を追加するときは「;」を挟んで追加し
  てください。ほかにコマンドラインオプションで日ごろ使うものがあ
  れば，ここに加えてください。 



・Step 5:  ilink32.cfgファイルの設定

  　ilink32.cfgの内容として，リンクするライブラリファイル(*.lib/*.o
  bjなど)が置かれているフォルダ(ディレクトリ)名の指定を行います。

  　フォルダ(ディレクトリ)名を追加するときは「;」を挟んで追加して
  ください。ほかにコマンドラインオプションで日ごろ使うものがあれば，
  ここに加えてください。

  　なお，同名のファイルが「インストール先+\bin」にあった場合，そ
  のファイルは上書きされます。



・Step 6:  設定の登録

  　ここで設定される項目とその内容が表示されます。

  　この設定でよければ[設定]ボタンを押してください。設定を書き込
  んでプログラムは終了します。設定が間違っている場合は[戻る]ボタ
  ンを押して，もう一度内容を入力してください。

  　また，設定せずにプログラムを終了させるには，メニューの[設定
  を反映させずに終了(X)]を選んでください。

  　設定された内容はコンピュータを再起動したあとに有効になります。
  必ずコンピュータをリセットしてください。

  　なお，同名のファイルが「インストール先+\bin」にあった場合，
  確認するダイヤログボックスが出て，[OK]ボタンを押すとそのファイ
  ルは上書きされます。[Cancel]ボタンを押すと上書きせず作業を実行
  します。



・Windows XP / NT / 2000 で環境変数が展開されない

  旧バージョンのsetbccではレジストリに書き込むとき，展開可能な文
  字列にするかどうかの確認をしていないため，

      -> Win32ディレクトリにあるコマンド(format，chkdsk)などが実
         行できない
      -> 一部のツールがコンソールから実行できない

  などの不具合が起きていました。

  この現象が出ている場合は，本ツールの[ヘルプ]->[WinNT/2000でパス
  の不具合を修整]を実行してください。これでうまく展開できるように
  なるはずです。



・動作検証

  Windows XP, Windows NT SP6，Windows 2000，Windows 98 SEで行いました。



・履歴

  [Ver. 1.5b]
  ドキュメントをちょっと変更(Windows XP/Meに対応)
  テキスト表示を広げて全画面見えるようにした
  Borland C++Builder 6でコンパイルした

  [Ver. 1.5a]
  ボーランド（株）への社名変更に対応

  [Ver. 1.5]
  AUTOEXEC.BATにEOFが入っていたときに対応
  ""で囲ってPATHを設定するように対応
  第4回公開版

  [Ver. 1.4a]
  ドキュメントをちょっと変更

  [Ver. 1.4]
  環境変数をいじくる部分を分離，TRegIniを使わないようにした
  Windows NT/2000で環境変数の展開が出来なかったのをfix
  設定するレジストリをシステム/ユーザ変数のうちどちらかに設定
  できるように変更
  第3回公開版

  [Ver. 1.3]
  やはりソースが情けないのでいろいろと直す
  ファイル上書き時に確認するようにした
  ilink32.cfgに，……lib\PSDK\を追加
  第2回公開版

  [Ver. 1.2]
  brc32.exeにおいてINCLUDE環境変数を指定しないとヘッダファイルを
  見に行かないことがあり，これを追加
  一部の文章表現を手直し

  [Ver. 1.1]
  公開版



・補遺

  Borland C++ Compiler 5.5.1はボーランド(株)が無償で配布してい
  るC++コンパイラです。こちらについてはhttp://www.borland.co.jp/
  を ご覧ください。

  プログラムのバグや改善点などが見つかりましたら，お手数ですが，
  cmaga@softbank.co.jpまでご一報ください。

  このプログラムはBorland C++Builder 6 Professionalにて作成しまし
  た。また，このプログラムは配布や改変が自由に行えるフリーソフト
  として公開します。雑誌の付録に付けていただいてかまいません:)

  不明な点はcmaga@softbank.co.jpまでご連絡ください。
